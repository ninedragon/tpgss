<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://www.mybatis.org/dtd/mybatis-3-config.dtd">
<mapper namespace="com.zz.common.dao.TEpuInfoMapper">
  <resultMap id="BaseResultMap" type="com.zz.common.model.TEpuInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="row_id" jdbcType="VARCHAR" property="rowId" />
    <result column="district_id" jdbcType="VARCHAR" property="districtId" />
    <result column="epu_name" jdbcType="VARCHAR" property="epuName" />
    <result column="epu_local" jdbcType="VARCHAR" property="epuLocal" />
    <result column="epu_province" jdbcType="VARCHAR" property="epuProvince" />
    <result column="epu_city" jdbcType="VARCHAR" property="epuCity" />
    <result column="epu_district" jdbcType="VARCHAR" property="epuDistrict" />
    <result column="epu_type" jdbcType="VARCHAR" property="epuType" />
    <result column="epu_type_name" jdbcType="VARCHAR" property="epuTypeName" />
    <result column="epu_xscale" jdbcType="DOUBLE" property="epuXscale" />
    <result column="epu_yscale" jdbcType="DOUBLE" property="epuYscale" />
    <result column="epu_parent_id" jdbcType="VARCHAR" property="epuParentId" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="CREATE_ID" jdbcType="VARCHAR" property="createId" />
    <result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="UPDATE_ID" jdbcType="VARCHAR" property="updateId" />
    <result column="DEL_FLAG" jdbcType="VARCHAR" property="delFlag" />
    <result column="address_id" jdbcType="VARCHAR" property="addressId" />
    <result column="epu_province_name" property="epuProvinceName" jdbcType="VARCHAR" />
    <result column="epu_city_name" property="epuCityName" jdbcType="VARCHAR" />
    <result column="epu_district_name" property="epuDistrictName" jdbcType="VARCHAR" />
    <result column="epu_status" property="epuStatus" jdbcType="VARCHAR" />
    <result column="epu_parent_name" property="epuParentName" jdbcType="VARCHAR" />
    <result column="epu_parent_type_name" property="epuParentTypeName" jdbcType="VARCHAR" />
    <result column="epu_parent_type" property="epuParentType" jdbcType="VARCHAR" />
    <result column="channel_id" property="channelId" jdbcType="VARCHAR" />
     <result column="line_id" property="lineId" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    row_id, district_id, epu_name, epu_local, epu_province, epu_city, epu_district, epu_type, 
    epu_xscale, epu_yscale, epu_parent_id, CREATE_TIME, CREATE_ID, UPDATE_TIME, UPDATE_ID, 
    DEL_FLAG, address_id,channel_id,line_id
  </sql>
   <sql id="where_all">
  	<where>
  	
     <if test="epuProvince != '' and epuProvince != null">  
	        and epu_province=  #{epuProvince,jdbcType=VARCHAR}
	    </if>
      </where>
  </sql>
  <sql id="limit_sql">
  	   <if test="page_sql != null and page_sql != ''">
      	${page_sql}
      </if>
  </sql>
    <select id="selectEpuInfoByRowId" parameterType="java.lang.String" resultMap="BaseResultMap" >
		SELECT
			epu.row_id,
			epu.district_id,
			epu.address_id,
			epu.epu_name,
			epu.epu_local,
			epu.epu_province,
			epu.epu_city,
			epu.epu_district,
			epu.epu_type,
			epu.epu_xscale,
			epu.epu_yscale,
			epu.epu_parent_id,
			epu.CREATE_TIME,
			epu.CREATE_ID,
			epu.UPDATE_TIME,
			epu.UPDATE_ID,
			epu.DEL_FLAG,
			epu.channel_id,
			epu.line_id,
			epu.epu_province_name,
			epu.epu_city_name,
			epu.epu_district_name,
			epu.epu_type_name,
			epu.epu_parent_name,
			epu.epu_parent_type,
             epu.epu_parent_type_name
			FROM
				view_epu_info epu
          where 1=1 and  epu.DEL_FLAG='0' 
            <if test="rowId != null and rowId !=''">
          and  epu.row_id = #{rowId,jdbcType=VARCHAR} 
          </if>
          	order by epu.UPDATE_TIME desc
  </select> 
    <select id="selectEpuInfoByMark" parameterType="com.zz.common.model.TEpuInfo" resultMap="BaseResultMap" >
		SELECT
			epu.row_id,
			epu.district_id,
			epu.address_id,
			epu.epu_name,
			epu.epu_local,
			epu.epu_province,
			epu.epu_city,
			epu.epu_district,
			epu.epu_type,
			epu.epu_xscale,
			epu.epu_yscale,
			epu.epu_parent_id,
			epu.CREATE_TIME,
			epu.CREATE_ID,
			epu.UPDATE_TIME,
			epu.UPDATE_ID,
			epu.DEL_FLAG,
			epu.channel_id,
			epu.line_id,
			epu.epu_province_name,
			epu_city_name,
			epu_district_name,
			epu_type_name,
			epu_parent_name,
			epu_parent_type,
            epu_parent_type_name
			FROM
				view_epu_info epu
          where 1=1 and  epu.DEL_FLAG='0' and epu.epu_type='M0001' and epu.epu_xscale IS NOT NULL and  epu.epu_Yscale IS NOT NULL 
            <if test="rowId != null and rowId !=''">
          and  epu.row_id = #{rowId,jdbcType=VARCHAR} 
          </if>
             <if test="epuCity != null and epuCity !=''">
          and  epu.epu_city = #{epuCity,jdbcType=VARCHAR} 
          </if>
            <if test="epuDistrict != null and epuDistrict !=''">
          and  epu.epu_district = #{epuDistrict,jdbcType=VARCHAR} 
          </if>
  </select>
  
  
      <select id="selectEpuInfos" parameterType="com.zz.common.model.TEpuInfo" resultMap="BaseResultMap" >
		SELECT
			epu.row_id,
			epu.district_id,
			epu.address_id,
			epu.epu_name,
			epu.epu_local,
			epu.epu_province,
			epu.epu_city,
			epu.epu_district,
			epu.epu_type,
			epu.epu_xscale,
			epu.epu_yscale,
			epu.epu_parent_id,
			epu.CREATE_TIME,
			epu.CREATE_ID,
			epu.UPDATE_TIME,
			epu.UPDATE_ID,
			epu.DEL_FLAG,
			epu.channel_id,
			epu.line_id,
			epu_province_name,
			epu_city_name,
			epu_district_name,
			epu_type_name,
			epu_parent_name,
			epu_parent_type,
            epu_parent_type_name
			FROM
				view_epu_info epu
          where 1=1 and  epu.DEL_FLAG='0' 
            <if test="rowId != null  and rowId !=''">
          and  epu.row_id = #{rowId,jdbcType=VARCHAR} 
          </if>
            <if test="epuParentId != null and epuParentId !=''">
          and  FIND_IN_SET(epu.row_id,getEpuChildrenList(#{epuParentId,jdbcType=VARCHAR}))
          </if>
           <if test="epuProvince != null and epuProvince !=''">
           and epu.epu_province=#{epuProvince,jdbcType=VARCHAR}     
              and epu.epu_type=#{epuType,jdbcType=VARCHAR}   
          </if>
            <if test="epuCity != null and epuCity !=''">
          and  epu.epu_city=#{epuCity,jdbcType=VARCHAR}
             and epu.epu_type=#{epuType,jdbcType=VARCHAR}
          </if>
            <if test="epuDistrict != null and epuDistrict !=''">
          and  epu.epu_district=#{epuDistrict,jdbcType=VARCHAR}
             and epu.epu_type=#{epuType,jdbcType=VARCHAR}
          </if>
          order by epu.UPDATE_TIME desc
  </select>
  
  
  <select id="findAll" resultMap="BaseResultMap" >
		SELECT
			epu.row_id,
			epu.district_id,
			epu.address_id,
			epu.epu_name,
			epu.epu_local,
			epu.epu_province,
			epu.epu_city,
			epu.epu_district,
			epu.epu_type,
			epu.epu_xscale,
			epu.epu_yscale,
			epu.epu_parent_id,
			epu.CREATE_TIME,
			epu.CREATE_ID,
			epu.UPDATE_TIME,
			epu.UPDATE_ID,
			epu.DEL_FLAG,
			epu.channel_id,
			epu.line_id,
			epu_province_name,
			epu_city_name,
			epu_district_name,
			epu_type_name,
			epu_parent_name,
			epu_parent_type,
            epu_parent_type_name
			FROM
				view_epu_info epu
			where 1=1    and  epu.DEL_FLAG='0'        
           <if test="epuProvince != '' and epuProvince != null">  
	        and epu.epu_province=  #{epuProvince,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuCity != '' and epuCity != null">  
	        and epu.epu_city=  #{epuCity,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuDistrict != '' and epuDistrict != null">  
	        and epu.epu_district=  #{epuDistrict,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuType != '' and epuType != null">  
	        and epu.epu_type=  #{epuType,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuName != '' and epuName != null"> 
	       and LOWER(epu.epu_name) like  LOWER(CONCAT("%",#{epuName,jdbcType=VARCHAR},"%")) 
	      </if>
	      	<if test="findContent != null and findContent !='' " >
        and (
        LOWER(epu.district_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%")) or
        LOWER(epu.address_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%")) or
        LOWER(epu.channel_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%"))
        )
      </if>	
    		order by epu.UPDATE_TIME desc
    		<include refid="limit_sql" />
  </select>
  <select id="findCount" resultMap="BaseResultMap" >
 	    select count(row_id) from  view_epu_info  epu 
 	     where 1=1    and  epu.DEL_FLAG='0'    
 	  	  <if test="epuProvince != '' and epuProvince != null">  
	        and epu.epu_province=  #{epuProvince,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuCity != '' and epuCity != null">  
	        and epu.epu_city=  #{epuCity,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuDistrict != '' and epuDistrict != null">  
	        and epu.epu_district=  #{epuDistrict,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuType != '' and epuType != null">  
	        and epu.epu_type=  #{epuType,jdbcType=VARCHAR}
	      </if>	
	      <if test="epuName != '' and epuName != null"> 
	       and LOWER(epu.epu_name) like  LOWER(CONCAT("%",#{epuName,jdbcType=VARCHAR},"%")) 
	      </if>	
	     <if test="findContent != null and findContent !='' " >
        and (
        LOWER(epu.district_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%")) or
        LOWER(epu.address_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%")) or
        LOWER(epu.channel_id) like  LOWER(CONCAT("%",#{findContent,jdbcType=VARCHAR},"%"))
        )
      </if>	
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from view_epu_info
    where row_id = #{rowId,jdbcType=VARCHAR} and DEL_FLAG='0'
  </select>
  
  
    <select id="selectDistrictId" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
   	SELECT DISTINCT
	C_DistrictBCDId AS district_id
	FROM
	t_deviceinfo
	order by C_DistrictBCDId
  </select>
  
      <select id="selectDIstinctByChannelId" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
   	SELECT 
	C_ChannelNum AS channel_id
	FROM
	t_deviceinfo
	where C_DistrictBCDId= #{districtId,jdbcType=VARCHAR} and C_AddressId= #{addressId,jdbcType=VARCHAR} 
	order by C_ChannelNum
  </select>
  
    <select id="selectAddressIdByDistrictId" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
   	SELECT 
	C_AddressId AS address_id
	FROM
	t_deviceinfo
	where C_DistrictBCDId = #{addressId,jdbcType=VARCHAR} 
	order by C_AddressId
  </select>
  
  <select id="selectByEpuType" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from view_epu_info
    where epu_type = #{epuType,jdbcType=VARCHAR} and epu_district = #{epuDistrict,jdbcType=VARCHAR} and DEL_FLAG='0' 
  </select>
  <delete id="deleteByPrimaryKey" parameterType="com.zz.common.model.TEpuInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from   
     <if test="epuType == 'M0001'">
         t_substain 
         </if>
          <if test="epuType == 'M0002'">
         t_outgoingCabinet 
         </if>  
          <if test="epuType == 'M0003'">
         t_branchBox 
         </if>  
           <if test="epuType == 'M0004'">
         t_meterBox 
         </if>
    where
     <if test="epuType == 'M0001'">
         substainId = #{rowId,jdbcType=VARCHAR} 
         </if>
          <if test="epuType == 'M0002'">
         outgoingCabinetId= #{rowId,jdbcType=VARCHAR}  
         </if>  
          <if test="epuType == 'M0003'">
         branchBoxId = #{rowId,jdbcType=VARCHAR} 
         </if>  
           <if test="epuType == 'M0004'">
         meterBoxId = #{rowId,jdbcType=VARCHAR} 
         </if>
  </delete>
  
    <insert id="insertSelective" parameterType="com.zz.common.model.TEpuInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into 
        <if test="epuType == 'M0001'">
         t_substain 
         </if>
          <if test="epuType == 'M0002'">
         t_outgoingCabinet 
         </if>  
          <if test="epuType == 'M0003'">
         t_branchBox 
         </if>  
           <if test="epuType == 'M0004'">
         t_meterBox 
         </if>    
    <trim prefix="(" suffix=")" suffixOverrides=",">
        <if test="rowId != null and rowId !=''" >
          <if test="epuType == 'M0001'">
         substainId,
         </if>
          <if test="epuType == 'M0002'">
         outgoingCabinetId ,
         </if>  
          <if test="epuType == 'M0003'">
         branchBoxId ,
         </if>  
           <if test="epuType == 'M0004'">
         meterBoxId ,
         </if>    
       
      </if>
      <if test="districtId != null and districtId !=''">
        C_DistrictBCDId,
      </if>
      <if test="epuName != null and epuName !=''">
        epu_name,
      </if>
      <if test="epuLocal != null and epuLocal !=''">
        epu_local,
      </if>
      <if test="epuProvince != null and epuProvince !=''">
        epu_province,
      </if>
      <if test="epuCity != null and epuCity !=''">
        epu_city,
      </if>
      <if test="epuDistrict != null and epuDistrict !=''">
        epu_district,
      </if>
      <if test="epuXscale != null and epuXscale !=''">
        epu_xscale,
      </if>
      <if test="epuYscale != null and epuYscale !=''">
        epu_yscale,
      </if>
      <if test="epuParentId != null and epuParentId !=''">
           
          <if test="epuType == 'M0002'">
         substainId ,
         </if>  
          <if test="epuType == 'M0003'">
         outgoingCabinetId ,
         </if>  
           <if test="epuType == 'M0004'">
         branchBoxId ,
         </if>    
      </if>
      <if test="createTime != null and createTime !=''">
        CREATE_TIME,
      </if>
      <if test="createId != null and createId !=''">
        CREATE_ID,
      </if>
      <if test="updateTime != null and updateTime !=''">
        UPDATE_TIME,
      </if>
      <if test="updateId != null and updateId !=''">
        UPDATE_ID,
      </if>
      <if test="delFlag != null and delFlag !=''">
        DEL_FLAG,
      </if>
      <if test="addressId != null and addressId !=''">
        C_AddressId,
      </if>
       <if test="channelId != null and channelId !=''">
        C_ChannelNum,
      </if>
       <if test="lineId != null and lineId !=''">
        line_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="rowId != null and rowId !=''">
        #{rowId,jdbcType=VARCHAR},
      </if>
      <if test="districtId != null and districtId !=''">
        #{districtId,jdbcType=VARCHAR},
      </if>
      <if test="epuName != null and epuName !=''">
        #{epuName,jdbcType=VARCHAR},
      </if>
      <if test="epuLocal != null and epuLocal !=''">
        #{epuLocal,jdbcType=VARCHAR},
      </if>
      <if test="epuProvince != null and epuProvince !=''">
        #{epuProvince,jdbcType=VARCHAR},
      </if>
      <if test="epuCity != null and epuCity !=''">
        #{epuCity,jdbcType=VARCHAR},
      </if>
      <if test="epuDistrict != null and epuDistrict !=''">
        #{epuDistrict,jdbcType=VARCHAR},
      </if>  
      <if test="epuXscale != null and epuXscale !=''">
        #{epuXscale,jdbcType=DOUBLE},
      </if>
      <if test="epuYscale != null and epuYscale !=''">
        #{epuYscale,jdbcType=DOUBLE},
      </if>
      <if test="epuParentId != null and epuParentId !=''">
        #{epuParentId,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null and createTime !=''">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createId != null and createId !=''">
        #{createId,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null and updateTime !=''">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateId != null and updateId !=''">
        #{updateId,jdbcType=VARCHAR},
      </if>
      <if test="delFlag != null and delFlag !=''">
        #{delFlag,jdbcType=VARCHAR},
      </if>
      <if test="addressId != null and addressId !=''">
        #{addressId,jdbcType=VARCHAR},
      </if>
      <if test="channelId != null and channelId !=''">
        #{channelId,jdbcType=VARCHAR},
      </if>
      <if test="lineId != null and lineId !=''">
        #{lineId,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <update id="updateByPrimaryKeySelective" parameterType="com.zz.common.model.TEpuInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update 
     <if test="epuType == 'M0001'">
         t_substain 
         </if>
          <if test="epuType == 'M0002'">
         t_outgoingCabinet 
         </if>  
          <if test="epuType == 'M0003'">
         t_branchBox 
         </if>  
           <if test="epuType == 'M0004'">
         t_meterBox 
         </if>
    <set>
      <if test="districtId != null and districtId !=''">
        C_DistrictBCDId = #{districtId,jdbcType=VARCHAR},
      </if>
      <if test="epuName != null and epuName !=''">
        epu_name = #{epuName,jdbcType=VARCHAR},
      </if>
      <if test="epuLocal != null and epuLocal !=''">
        epu_local = #{epuLocal,jdbcType=VARCHAR},
      </if>
      <if test="epuProvince != null and epuProvince !=''">
        epu_province = #{epuProvince,jdbcType=VARCHAR},
      </if>
      <if test="epuCity != null and epuCity !=''">
        epu_city = #{epuCity,jdbcType=VARCHAR},
      </if>
      <if test="epuDistrict != null and epuDistrict !=''">
        epu_district = #{epuDistrict,jdbcType=VARCHAR},
      </if>
      <if test="epuXscale != null and epuXscale !=''">
        epu_xscale = #{epuXscale,jdbcType=DOUBLE},
      </if>
      <if test="epuYscale != null and epuYscale !=''">
        epu_yscale = #{epuYscale,jdbcType=DOUBLE},
      </if>
      <if test="epuParentId != null and epuParentId !=''">
        <if test="epuType == 'M0002'">
         substainId =#{epuParentId,jdbcType=VARCHAR},
         </if>  
          <if test="epuType == 'M0003'">
         outgoingCabinetId=#{epuParentId,jdbcType=VARCHAR},
         </if>  
           <if test="epuType == 'M0004'">
         branchBoxId=#{epuParentId,jdbcType=VARCHAR},
         </if>
      </if>
      <if test="createTime != null and createTime !=''">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createId != null and createId !=''">
        CREATE_ID = #{createId,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null and updateTime !=''">
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateId != null and updateId !=''">
        UPDATE_ID = #{updateId,jdbcType=VARCHAR},
      </if>
      <if test="delFlag != null and delFlag !=''">
        DEL_FLAG = #{delFlag,jdbcType=VARCHAR},
      </if>
      <if test="addressId != null and addressId !=''">
        C_AddressId = #{addressId,jdbcType=VARCHAR},
      </if>
      <if test="channelId != null and channelId !=''">
        C_ChannelNum = #{channelId,jdbcType=VARCHAR},
      </if>
      <if test="lineId != null and lineId !=''">
        line_id = #{lineId,jdbcType=VARCHAR},
      </if>
    </set>
    where 1=1
       <if test="epuType == 'M0001'">
         and substainId = #{rowId,jdbcType=VARCHAR} 
         </if>
          <if test="epuType == 'M0002'">
         and outgoingCabinetId= #{rowId,jdbcType=VARCHAR}  
         </if>  
          <if test="epuType == 'M0003'">
        and  branchBoxId = #{rowId,jdbcType=VARCHAR} 
         </if>  
           <if test="epuType == 'M0004'">
         and meterBoxId = #{rowId,jdbcType=VARCHAR} 
         </if>
    and DEL_FLAG='0'
  </update>

    <update id="delMarkByRowId" parameterType="java.lang.String">  
    update t_substain
    set 
      epu_xscale = null,
      epu_yscale = null
    where substainId = #{rowId,jdbcType=VARCHAR} and DEL_FLAG='0'
  </update>
  
  
    <select id="checkEpName" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
     <include refid="Base_Column_List" />
    from view_epu_info
    where epu_name = #{epuName,jdbcType=VARCHAR}  and epu_district = #{epuDistrict,jdbcType=VARCHAR} and  epu_type = #{epuType,jdbcType=VARCHAR}    and DEL_FLAG='0'
  </select>
</mapper>